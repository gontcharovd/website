{{/* Custom newsletter subscription form for Kit (ConvertKit) */}}

<div class="subscribe-form">
    <form
        action="https://app.convertkit.com/forms/8199782/subscriptions"
        method="post"
        class="newsletter-form"
        id="newsletter-form"
    >
        <input name="utf8" type="hidden" value="âœ“" />
        <div class="input-group">
            <input
                type="email"
                name="email_address"
                placeholder="Your email address"
                required
                aria-label="Email address"
            />
            <button type="submit">Subscribe</button>
        </div>
        <div class="privacy-notice">
            <small>No spam, unsubscribe at any time.</small>
        </div>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("newsletter-form");

        form.addEventListener("submit", function (e) {
            e.preventDefault();

            const formData = new FormData(form);

            // Submit the form to ConvertKit
            fetch(form.action, {
                method: "POST",
                body: formData,
                mode: "no-cors",
            })
                .then(() => {
                    // Redirect to thank you page after submission
                    window.location.href = "https://gontcharov.eu/thank-you/";
                })
                .catch(() => {
                    // Still redirect to thank you page even if there's an error
                    // (because no-cors mode won't give us error details anyway)
                    window.location.href = "https://gontcharov.eu/thank-you/";
                });
        });
    });
</script>

<style>
    .subscribe-form {
        margin: 2rem 0;
        border: none !important;
        background: transparent !important;
    }

    .newsletter-form {
        border: none !important;
        background: transparent !important;
    }

    .newsletter-form .input-group {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
        flex-wrap: wrap;
    }

    .newsletter-form input[type="email"] {
        flex: 1;
        min-width: 250px;
        max-width: 350px;
        padding: 0.5rem 1rem;
        border: 1px solid var(--border);
        border-radius: 6px;
        background: var(--theme);
        color: var(--primary);
        font-size: 1rem;
        transition: border-color 0.2s ease;
    }

    .newsletter-form input[type="email"]:focus {
        outline: none;
        border-color: var(--tertiary);
    }

    .newsletter-form button {
        padding: 0.5rem 1.5rem;
        background: #cb3a56;
        color: var(--theme);
        border: none;
        border-radius: 6px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.2s ease;
        white-space: nowrap;
        min-width: 120px;
    }

    .newsletter-form button:hover {
        background: #a53248;
    }

    .privacy-notice {
        text-align: center;
        color: var(--secondary);
        font-size: 0.9rem;
    }

    @media (max-width: 600px) {
        .newsletter-form .input-group {
            flex-direction: column;
        }

        .newsletter-form input[type="email"] {
            min-width: 100%;
        }

        .newsletter-form button {
            width: 100%;
        }
    }
</style>
